Version =21
VersionRequired =20
Begin Form
    AllowFilters = NotDefault
    PopUp = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    DataEntry = NotDefault
    DefaultView =0
    ScrollBars =2
    BorderStyle =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =7620
    DatasheetFontHeight =11
    ItemSuffix =47
    Left =3825
    Top =3105
    Right =16980
    Bottom =14490
    DatasheetGridlinesColor =14806254
    RecSrcDt = Begin
        0x40a16385ede1e440
    End
    Caption ="Add Template"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =2700
            BackColor =4144959
            Name ="FormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            Begin
                Begin Label
                    OverlapFlags =93
                    Width =3480
                    Height =300
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblTitle"
                    GridlineColor =10921638
                    LayoutCachedWidth =3480
                    LayoutCachedHeight =300
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                End
                Begin Label
                    OverlapFlags =223
                    Left =120
                    Top =120
                    Width =7260
                    Height =1980
                    BorderColor =8355711
                    ForeColor =16777164
                    Name ="lblDirections"
                    Caption ="Enter template details below using the standard template naming conventions (see"
                        " hints below) and save.\015\012\015\012The new template will appear at the botto"
                        "m of the template list.\015\012\015\012To format your template text, use the Not"
                        "epad button at right,\015\012then copy && paste it into the template textbox."
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =120
                    LayoutCachedWidth =7380
                    LayoutCachedHeight =2100
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextFontFamily =2
                    Left =6660
                    Top =1440
                    Width =600
                    Height =660
                    FontSize =8
                    ForeColor =255
                    Name ="btnOpenNotepad"
                    Caption ="notepad"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000020000000200000000100040000000000000200000000000000000000 ,
                        0x1000000000000000000000000000bf0000bf000000bfbf00bf000000bf00bf00 ,
                        0xbfbf0000c0c0c000808080000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00777777777777000000000000000007777777777777708888 ,
                        0x8888888888888077777777777707777777777777777788077777777770ffffff ,
                        0xfffffffffff77807777777777077777777777fffffff78077777777770888888 ,
                        0x888888888888780777777777707777777777777fffff78077777777770777777 ,
                        0x7777777fffff7807777777777088888888888888888878077777777770777777 ,
                        0x77777777ffff7807770000000000000000007777ffff78077066666666666666 ,
                        0x666608888888780770e7e7e7e7e7e7e7e7e607777fff7807707e7e7e7e7e7e7e ,
                        0x7e7e60777fff78077707e7e7e7e7e7e7e7e7608888887807770e7e7e7e7e7e7e ,
                        0x7e7e760777ff78077770e7e7e7e7e7e7e7e7e60777ff780777707e7e7e7e7e7e ,
                        0x7e7e7e6088887807777707e7e7e7e7e7e7e7e760777f780777770e7e7e7e7e7e ,
                        0x7e7e7e76077f7807777770e7e7e7e7e7e7e7e7e6088878077777707e7e000000 ,
                        0x00007e7e6077780777777707e7e7e7e7e7e7e7e7607778077777770e7e700000 ,
                        0x00000e7e7607780777777770e7e7e7e7e7e7e7e7e6077807777777707e7e7e7e ,
                        0x7e7e7e7e7e6078077777777707e7e7e7e7e7e7e7e7607807777777770e0e707e ,
                        0x0e707e0e707600777777777770f00f00f00f00f00f0007777777777777007007 ,
                        0x0070070070077777777777777777777777777777777777777777777777777777 ,
                        0x7777777777777777000000000000000000000000000000000000000000000000
                    End
                    FontName ="Academy Engraved LET"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =6660
                    LayoutCachedTop =1440
                    LayoutCachedWidth =7260
                    LayoutCachedHeight =2100
                    ForeThemeColorIndex =-1
                    BackColor =14136213
                    BorderColor =14136213
                    ThemeFontIndex =-1
                    HoverColor =65280
                    HoverThemeColorIndex =-1
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =1200
                    Top =2280
                    Width =615
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblTemplateName"
                    Caption ="Name"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638
                    LayoutCachedLeft =1200
                    LayoutCachedTop =2280
                    LayoutCachedWidth =1815
                    LayoutCachedHeight =2595
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Label
                    OverlapFlags =85
                    Left =5400
                    Top =2280
                    Width =675
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblSyntax"
                    Caption ="Syntax"
                    GridlineColor =10921638
                    LayoutCachedLeft =5400
                    LayoutCachedTop =2280
                    LayoutCachedWidth =6075
                    LayoutCachedHeight =2595
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            CanShrink = NotDefault
            Height =5040
            Name ="Detail"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Left =5760
                    Top =1920
                    Width =1500
                    Height =360
                    BackColor =65535
                    BorderColor =10921638
                    Name ="rctAlert"
                    GridlineColor =10921638
                    LayoutCachedLeft =5760
                    LayoutCachedTop =1920
                    LayoutCachedWidth =7260
                    LayoutCachedHeight =2280
                    BackThemeColorIndex =-1
                End
                Begin TextBox
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =120
                    Top =45
                    Width =360
                    Height =315
                    FontSize =9
                    TabIndex =8
                    BorderColor =8355711
                    ForeColor =690698
                    Name ="tbxIcon"
                    GridlineColor =10921638

                    LayoutCachedLeft =120
                    LayoutCachedTop =45
                    LayoutCachedWidth =480
                    LayoutCachedHeight =360
                    BorderThemeColorIndex =0
                    BorderTint =50.0
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =50.0
                End
                Begin CommandButton
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextFontFamily =2
                    Left =6600
                    Width =720
                    FontSize =14
                    TabIndex =7
                    ForeColor =255
                    Name ="btnDelete"
                    Caption =""
                    OnClick ="[Event Procedure]"
                    FontName ="Academy Engraved LET"
                    GridlineColor =10921638

                    LayoutCachedLeft =6600
                    LayoutCachedWidth =7320
                    LayoutCachedHeight =360
                    PictureCaptionArrangement =5
                    ForeThemeColorIndex =-1
                    BackColor =14136213
                    BorderColor =14136213
                    ThemeFontIndex =-1
                    HoverColor =65280
                    HoverThemeColorIndex =-1
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1140
                    Top =60
                    Width =4020
                    Height =315
                    FontSize =9
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxTemplate"
                    OnChange ="[Event Procedure]"
                    ConditionalFormat = Begin
                        0x0100000094000000020000000100000000000000000000001500000001000000 ,
                        0x00000000fff20000000000000300000016000000190000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x4c0065006e0028002200740062007800540065006d0070006c00610074006500 ,
                        0x220029003d003000000000002200220000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =1140
                    LayoutCachedTop =60
                    LayoutCachedWidth =5160
                    LayoutCachedHeight =375
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff20000140000004c00 ,
                        0x65006e0028002200740062007800540065006d0070006c006100740065002200 ,
                        0x29003d0030000000000000000000000000000000000000000000000000000003 ,
                        0x0000000100000000000000ffffff000200000022002200000000000000000000 ,
                        0x000000000000000000000000
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    BackStyle =0
                    IMESentenceMode =3
                    Left =600
                    Top =45
                    Width =360
                    Height =315
                    FontSize =9
                    TabIndex =9
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="tbxID"
                    GridlineColor =10921638

                    LayoutCachedLeft =600
                    LayoutCachedTop =45
                    LayoutCachedWidth =960
                    LayoutCachedHeight =360
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    Left =6180
                    Top =600
                    Width =1020
                    Height =315
                    FontSize =9
                    TabIndex =4
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxVersion"
                    OnChange ="[Event Procedure]"
                    ConditionalFormat = Begin
                        0x0100000092000000020000000100000000000000000000001400000001000000 ,
                        0x00000000fff20000000000000300000015000000180000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x4c0065006e0028005b00740062007800560065007200730069006f006e005d00 ,
                        0x29003d003000000000002200220000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =6180
                    LayoutCachedTop =600
                    LayoutCachedWidth =7200
                    LayoutCachedHeight =915
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff20000130000004c00 ,
                        0x65006e0028005b00740062007800560065007200730069006f006e005d002900 ,
                        0x3d00300000000000000000000000000000000000000000000000000000030000 ,
                        0x000100000000000000ffffff0002000000220022000000000000000000000000 ,
                        0x00000000000000000000
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =2
                    IMESentenceMode =3
                    Left =6180
                    Top =1260
                    Width =1020
                    Height =315
                    FontSize =9
                    TabIndex =5
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxEffectiveDate"
                    Format ="Short Date"
                    OnChange ="[Event Procedure]"
                    ConditionalFormat = Begin
                        0x01000000b0000000020000000100000000000000000000002300000001000000 ,
                        0x00000000fff20000000000000300000024000000270000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x49004900660028004c0065006e00280022007400620078004500660066006500 ,
                        0x630074006900760065004400610074006500220029003d0030002c0031002c00 ,
                        0x30002900000000002200220000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =6180
                    LayoutCachedTop =1260
                    LayoutCachedWidth =7200
                    LayoutCachedHeight =1575
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff20000220000004900 ,
                        0x4900660028004c0065006e002800220074006200780045006600660065006300 ,
                        0x74006900760065004400610074006500220029003d0030002c0031002c003000 ,
                        0x2900000000000000000000000000000000000000000000000000000300000001 ,
                        0x00000000000000ffffff00020000002200220000000000000000000000000000 ,
                        0x0000000000000000
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1080
                    Top =1200
                    Width =4140
                    Height =720
                    FontSize =9
                    TabIndex =2
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxRemarks"
                    OnChange ="[Event Procedure]"
                    ConditionalFormat = Begin
                        0x0100000092000000020000000100000000000000000000001400000001000000 ,
                        0x00000000fff20000000000000300000015000000180000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x4c0065006e0028002200740062007800520065006d00610072006b0073002200 ,
                        0x29003d003000000000002200220000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =1080
                    LayoutCachedTop =1200
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =1920
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff20000130000004c00 ,
                        0x65006e0028002200740062007800520065006d00610072006b00730022002900 ,
                        0x3d00300000000000000000000000000000000000000000000000000000030000 ,
                        0x000100000000000000ffffff0002000000220022000000000000000000000000 ,
                        0x00000000000000000000
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =6780
                    Top =60
                    Width =720
                    TabIndex =6
                    ForeColor =4210752
                    Name ="btnSave"
                    Caption ="Save"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Save record"
                    GridlineColor =10921638
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000d0687050c06860ffb05850ffa05050ffa05050ff ,
                        0xa05050ff904850ff904840ff904840ff804040ff803840ff803840ff703840ff ,
                        0x703830ff0000000000000000d06870fff09090ffe08080ffb04820ff403020ff ,
                        0xc0b8b0ffc0b8b0ffd0c0c0ffd0c8c0ff505050ffa04030ffa04030ffa03830ff ,
                        0x703840ff0000000000000000d07070ffff98a0fff08880ffe08080ff705850ff ,
                        0x404030ff907870fff0e0e0fff0e8e0ff908070ffa04030ffa04040ffa04030ff ,
                        0x803840ff0000000000000000d07870ffffa0a0fff09090fff08880ff705850ff ,
                        0x000000ff404030fff0d8d0fff0e0d0ff807860ffb04840ffb04840ffa04040ff ,
                        0x804040ff0000000000000000d07880ffffa8b0ffffa0a0fff09090ff705850ff ,
                        0x705850ff705850ff705850ff706050ff806860ffc05850ffb05050ffb04840ff ,
                        0x804040ff0000000000000000e08080ffffb0b0ffffb0b0ffffa0a0fff09090ff ,
                        0xf08880ffe08080ffe07880ffd07070ffd06870ffc06060ffc05850ffb05050ff ,
                        0x904840ff0000000000000000e08890ffffb8c0ffffb8b0ffd06060ffc06050ff ,
                        0xc05850ffc05040ffb05030ffb04830ffa04020ffa03810ffc06060ffc05850ff ,
                        0x904840ff0000000000000000e09090ffffc0c0ffd06860ffffffffffffffffff ,
                        0xfff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffe0c8c0ffa03810ffc06060ff ,
                        0x904850ff0000000000000000e098a0ffffc0c0ffd07070ffffffffffffffffff ,
                        0xfffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffa04020ffd06860ff ,
                        0xa05050ff0000000000000000f0a0a0ffffc0c0ffe07870ffffffffffffffffff ,
                        0xfffffffffffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffb04830ffd07070ff ,
                        0xa05050ff0000000000000000f0a8a0ffffc0c0ffe08080ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffff8f0fff0f0f0fff0e8e0ffb05030ffe07880ff ,
                        0xa05050ff0000000000000000f0b0b0ffffc0c0fff08890ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffff8f0fff0f0f0ffc05040ff603030ff ,
                        0xb05850ff0000000000000000f0b0b0ffffc0c0ffff9090ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffffffffffff8f0ffc05850ffb05860ff ,
                        0xb05860ff0000000000000000f0b8b0fff0b8b0fff0b0b0fff0b0b0fff0a8b0ff ,
                        0xf0a0a0ffe098a0ffe09090ffe09090ffe08890ffe08080ffd07880ffd07870ff ,
                        0xd07070ff00000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =6780
                    LayoutCachedTop =60
                    LayoutCachedWidth =7500
                    LayoutCachedHeight =420
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =65280
                    HoverThemeColorIndex =-1
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =3
                    Left =5340
                    Top =60
                    Width =900
                    Height =300
                    FontSize =9
                    TabIndex =1
                    BoundColumn =2
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    ConditionalFormat = Begin
                        0x01000000a2000000020000000100000000000000000000001c00000001000000 ,
                        0x00000000fff2000000000000030000001d000000200000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x49004900660028004c0065006e0028002200630062007800530079006e007400 ,
                        0x61007800220029003d0030002c0031002c003000290000000000220022000000 ,
                        0x0000
                    End
                    Name ="cbxSyntax"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;0;1"
                    DefaultValue ="\"T-SQL\""
                    OnChange ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =5340
                    LayoutCachedTop =60
                    LayoutCachedWidth =6240
                    LayoutCachedHeight =360
                    BackThemeColorIndex =-1
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff200001b0000004900 ,
                        0x4900660028004c0065006e0028002200630062007800530079006e0074006100 ,
                        0x7800220029003d0030002c0031002c0030002900000000000000000000000000 ,
                        0x00000000000000000000000000030000000100000000000000ffffff00020000 ,
                        0x0022002200000000000000000000000000000000000000000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =180
                    Top =1200
                    Width =870
                    Height =315
                    BorderColor =10921638
                    ForeColor =8355711
                    Name ="lblRemarks"
                    Caption ="Remarks"
                    GridlineColor =10921638
                    LayoutCachedLeft =180
                    LayoutCachedTop =1200
                    LayoutCachedWidth =1050
                    LayoutCachedHeight =1515
                    BorderThemeColorIndex =1
                    BorderTint =100.0
                    BorderShade =65.0
                End
                Begin Label
                    OverlapFlags =85
                    Left =5400
                    Top =600
                    Width =720
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblVersion"
                    Caption ="Version"
                    GridlineColor =10921638
                    LayoutCachedLeft =5400
                    LayoutCachedTop =600
                    LayoutCachedWidth =6120
                    LayoutCachedHeight =915
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =2220
                    Width =915
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblTemplate"
                    Caption ="Template"
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =2220
                    LayoutCachedWidth =1035
                    LayoutCachedHeight =2535
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =87
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1080
                    Top =2280
                    Width =6120
                    Height =2040
                    FontSize =9
                    TabIndex =3
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxTemplateSQL"
                    OnKeyPress ="[Event Procedure]"
                    OnChange ="[Event Procedure]"
                    ConditionalFormat = Begin
                        0x01000000cc000000030000000100000000000000000000001900000001000000 ,
                        0x00000000fff2000000000000030000001a0000001d0000000100000000000000 ,
                        0xffffff0001000000000000001e0000003500000001000000ed1c2400ffffff00 ,
                        0x4c0065006e0028002200740062007800540065006d0070006c00610074006500 ,
                        0x530051004c00220029003d00220022000000000022002200000000004c006500 ,
                        0x6e0028005b00740062007800540065006d0070006c006100740065005d002900 ,
                        0x3e0032003500350000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =1080
                    LayoutCachedTop =2280
                    LayoutCachedWidth =7200
                    LayoutCachedHeight =4320
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000300000001000000000000000100000000000000fff20000180000004c00 ,
                        0x65006e0028002200740062007800540065006d0070006c006100740065005300 ,
                        0x51004c00220029003d0022002200000000000000000000000000000000000000 ,
                        0x00000000000000030000000100000000000000ffffff00020000002200220000 ,
                        0x0000000000000000000000000000000000000000010000000000000001000000 ,
                        0xed1c2400ffffff00160000004c0065006e0028005b0074006200780054006500 ,
                        0x6d0070006c006100740065005d0029003e003200350035000000000000000000 ,
                        0x00000000000000000000000000
                    End
                End
                Begin Label
                    OverlapFlags =87
                    Left =5280
                    Top =1260
                    Width =900
                    Height =555
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblEffectiveDate"
                    Caption ="Effective Date"
                    GridlineColor =10921638
                    LayoutCachedLeft =5280
                    LayoutCachedTop =1260
                    LayoutCachedWidth =6180
                    LayoutCachedHeight =1815
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =93
                    Left =1140
                    Top =420
                    Width =4020
                    Height =600
                    FontSize =8
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =16737792
                    Name ="lblTemplateNameHint"
                    Caption ="Naming conventions: \015\012                              s_ = select        d_ "
                        "= delete    i_ = insert\015\012                              u_ = update    qa_ "
                        "= QA      qsys_ = system"
                    GridlineColor =10921638
                    LayoutCachedLeft =1140
                    LayoutCachedTop =420
                    LayoutCachedWidth =5160
                    LayoutCachedHeight =1020
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1140
                    Top =780
                    Width =4020
                    Height =315
                    FontSize =9
                    TabIndex =10
                    BackColor =65535
                    BorderColor =10921638
                    ForeColor =4138256
                    Name ="tbxContext"
                    ConditionalFormat = Begin
                        0x0100000094000000020000000100000000000000000000001500000001000000 ,
                        0x00000000fff20000000000000300000016000000190000000100000000000000 ,
                        0xffffff0000000000000000000000000000000000000000000000000000000000 ,
                        0x4c0065006e0028002200740062007800540065006d0070006c00610074006500 ,
                        0x220029003d003000000000002200220000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =1140
                    LayoutCachedTop =780
                    LayoutCachedWidth =5160
                    LayoutCachedHeight =1095
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                    ForeShade =50.0
                    ConditionalFormat14 = Begin
                        0x01000200000001000000000000000100000000000000fff20000140000004c00 ,
                        0x65006e0028002200740062007800540065006d0070006c006100740065002200 ,
                        0x29003d0030000000000000000000000000000000000000000000000000000003 ,
                        0x0000000100000000000000ffffff000200000022002200000000000000000000 ,
                        0x000000000000000000000000
                    End
                End
                Begin Label
                    FontItalic = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =900
                    Top =4380
                    Width =6420
                    Height =600
                    FontSize =8
                    FontWeight =500
                    BorderColor =255
                    ForeColor =16737792
                    Name ="lblTemplateMax"
                    Caption ="Templates over 255 characters must be edited directly in the template table afte"
                        "r saving. \015\012Save the template, then edit the new template's SQL text in th"
                        "e table (only the first 255 characters are saved)."
                    GridlineColor =10921638
                    LayoutCachedLeft =900
                    LayoutCachedTop =4380
                    LayoutCachedWidth =7320
                    LayoutCachedHeight =4980
                    BorderThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =3540
                    Top =1980
                    Width =2160
                    Height =240
                    FontSize =9
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblCharacterCount"
                    Caption ="Character Count"
                    GridlineColor =10921638
                    LayoutCachedLeft =3540
                    LayoutCachedTop =1980
                    LayoutCachedWidth =5700
                    LayoutCachedHeight =2220
                End
                Begin Label
                    OverlapFlags =223
                    TextAlign =2
                    Left =5160
                    Top =1980
                    Width =660
                    Height =240
                    FontSize =9
                    BorderColor =8355711
                    Name ="lblCount"
                    GridlineColor =10921638
                    LayoutCachedLeft =5160
                    LayoutCachedTop =1980
                    LayoutCachedWidth =5820
                    LayoutCachedHeight =2220
                    ForeThemeColorIndex =-1
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    Left =5820
                    Top =1980
                    Width =1380
                    Height =240
                    FontSize =9
                    BorderColor =8355711
                    ForeColor =255
                    Name ="lblMaxCount"
                    Caption ="-1 remaining"
                    GridlineColor =10921638
                    LayoutCachedLeft =5820
                    LayoutCachedTop =1980
                    LayoutCachedWidth =7200
                    LayoutCachedHeight =2220
                    ForeThemeColorIndex =-1
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' =================================
' Form:         TemplateAdd
' Level:        Application form
' Version:      1.02
' Basis:        Dropdown form
'
' Description:  Add record form object related properties, events, functions & procedures for UI display
'
' Source/date:  Bonnie Campbell, October 4, 2016
' References:   -
' Revisions:    BLC - 10/4/2016 - 1.00 - initial version
'               BLC - 1/31/2017 - 1.01 - adjusted to set ID value = 0 to signal template
'                                        add vs. update
'               BLC - 2/1/2017  - 1.02 - adjusted to set hidden context value,
'                                        revised to unbound form (avoids template double save)
'                                        adjust to retrieve valid syntaxes from AppEnum
'                                        added CallingForm property
'               BLC - 2/2/2017 - 1.03 - truncate template SQL to 255 chars (others need to be added to table directly)
'                                       add character counter & tbxTemplate_Change()
'                                       added textbox & combobox change events
' =================================

'---------------------
' Simulated Inheritance
'---------------------

'---------------------
' Declarations
'---------------------
Private m_Title As String
Private m_Directions As String
Private m_CallingForm As String

Private m_CountLabel As String
Private m_CurrentCount As String
Private m_MaxCount As String
Private m_AlertCount As Integer
Private m_RemainingCount As String

Private m_CountLabelFontColor As Long
Private m_CurrentCountFontColor As Long
Private m_MaxCountFontColor As Long
Private m_RemainingCountFontColor As Long
Private m_AlertBoxBackgroundColor As Long

Private m_CountLabelVisible As Byte
Private m_CurrentCountVisible As Byte
Private m_MaxCountVisible As Byte
Private m_RemainingCountVisible As Byte
Private m_AlertCountVisible As Byte
Private m_AlertBoxVisible As Byte

'---------------------
' Event Declarations
'---------------------
Public Event InvalidTitle(value As String)
Public Event InvalidDirections(value As String)
Public Event InvalidCallingForm(value As String)

'---------------------
' Properties
'---------------------
Public Property Let title(value As String)
    If Len(value) > 0 Then
        m_Title = value

        'set the form title & caption
        Me.lblTitle.Caption = m_Title
        Me.Caption = m_Title
    Else
        RaiseEvent InvalidTitle(value)
    End If
End Property

Public Property Get title() As String
    title = m_Title
End Property

Public Property Let Directions(value As String)
    If Len(value) > 0 Then
        m_Directions = value

        'set the form directions
        Me.lblDirections.Caption = m_Directions
    Else
        RaiseEvent InvalidDirections(value)
    End If
End Property

Public Property Get Directions() As String
    Directions = m_Directions
End Property

Public Property Let CallingForm(value As String)
    If Len(value) > 0 Then
        m_CallingForm = value
    Else
        RaiseEvent InvalidCallingForm(value)
    End If
End Property

Public Property Get CallingForm() As String
    CallingForm = m_CallingForm
End Property

Public Property Get CountLabel() As String
    CountLabel = m_CountLabel
End Property

Public Property Let CountLabel(value As String)
    If Len(Trim(value)) = 0 Then value = "Character Count"
    If ValidateString(value, "alphanumdashslashspace") Then
        m_CountLabel = value
    End If
    lblCharacterCount.Caption = m_CountLabel
End Property

Public Property Get CurrentCount() As String
    CurrentCount = m_CurrentCount
End Property

Public Property Let CurrentCount(value As String)
    If Len(Trim(value)) = 0 Then value = "1"
    If ValidateString(value, "numeric") Then
        m_CurrentCount = value
    End If
    lblCount.Caption = m_CurrentCount
End Property

Public Property Get MaxCount() As String
    MaxCount = m_MaxCount
End Property

Public Property Let MaxCount(value As String)
    If Len(Trim(value)) = 0 Then value = "/ XX characters"
    If ValidateString(value, "alphanumdashslashspace") Then
        m_MaxCount = value
    End If
    lblMaxCount.Caption = m_MaxCount
End Property

'set the value at which the count display changes color
Public Property Get AlertCount() As Integer
    AlertCount = m_AlertCount
End Property

Public Property Let AlertCount(value As Integer)
    If Len(Trim(value)) = 0 Then value = 10
    m_AlertCount = value
End Property

Public Property Get RemainingCount() As String
    RemainingCount = m_RemainingCount
End Property

Public Property Let RemainingCount(value As String)
    If Len(Trim(value)) = 0 Then value = "XX characters remain"
    If ValidateString(value, "alphanumdashslashspace") Then
        m_RemainingCount = value
    End If
    lblMaxCount.Caption = m_RemainingCount
End Property

' ==== Color =========
Public Property Get CountLabelFontColor() As Long
    CountLabelFontColor = m_CountLabelFontColor
End Property

Public Property Let CountLabelFontColor(value As Long)
    m_CountLabelFontColor = value
    lblCount.ForeColor = m_CountLabelFontColor
End Property

Public Property Get CurrentCountFontColor() As Long
    CurrentCountFontColor = m_CurrentCountFontColor
End Property

Public Property Let CurrentCountFontColor(value As Long)
    m_CurrentCountFontColor = value
    lblCount.ForeColor = m_CurrentCountFontColor
End Property

Public Property Get MaxCountFontColor() As Long
    MaxCountFontColor = m_MaxCountFontColor
End Property

Public Property Let MaxCountFontColor(value As Long)
    m_MaxCountFontColor = value
    lblMaxCount.ForeColor = m_MaxCountFontColor
End Property

Public Property Get RemainingCountFontColor() As Long
    RemainingCountFontColor = m_RemainingCountFontColor
End Property

Public Property Let RemainingCountFontColor(value As Long)
    m_RemainingCountFontColor = value
    lblMaxCount.ForeColor = m_RemainingCountFontColor
End Property

Public Property Get AlertBoxBackgroundColor() As Long
    AlertBoxBackgroundColor = m_AlertBoxBackgroundColor
End Property

Public Property Let AlertBoxBackgroundColor(value As Long)
    rctAlert.BackStyle = 1 '1 = Normal, 0 = Transparent
    m_AlertBoxBackgroundColor = value
    rctAlert.BackColor = m_AlertBoxBackgroundColor
End Property

' ==== Visibility ====
Public Property Get CountLabelVisible() As Byte
    CountLabelVisible = m_CountLabelVisible
End Property

Public Property Let CountLabelVisible(value As Byte)
    m_CountLabelVisible = value
    lblCount.Visible = m_CountLabelVisible
End Property

Public Property Get CurrentCountVisible() As Byte
    CurrentCountVisible = m_CurrentCountVisible
End Property

Public Property Let CurrentCountVisible(value As Byte)
    m_CurrentCountVisible = value
    lblCount.Visible = m_CurrentCountVisible
End Property

Public Property Get MaxCountVisible() As Byte
    MaxCountVisible = m_MaxCountVisible
End Property

Public Property Let MaxCountVisible(value As Byte)
    m_MaxCountVisible = value
    lblMaxCount.Visible = m_MaxCountVisible
End Property

Public Property Get RemainingCountVisible() As Byte
    RemainingCountVisible = m_RemainingCountVisible
End Property

Public Property Let RemainingCountVisible(value As Byte)
    m_RemainingCountVisible = value
End Property

Public Property Get AlertBoxVisible() As Byte
    AlertBoxVisible = m_AlertBoxVisible
End Property

Public Property Let AlertBoxVisible(value As Byte)
    m_AlertBoxVisible = value
    Me.rctAlert.Visible = m_AlertBoxVisible
End Property


'---------------------
' Methods
'---------------------

' ---------------------------------
' Sub:          Form_Open
' Description:  form opening actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:
'   Microsoft, unknown
'   https://msdn.microsoft.com/en-us/library/office/aa223974(v=office.11).aspx
' Source/date:  Bonnie Campbell, October 4, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 10/4/2016 - initial version
'   BLC - 2/1/2017 - revised to unbound form (avoids double save of template)
'                    adjust to retrieve valid syntaxes from AppEnum
'                    added CallingForm default, adjusted directions
'   BLC - 2/2/2017 - handle Template memo truncation since > 255 yields
'                    error 3271 SetRecord mod_App_Data  Invalid property value.
' ---------------------------------
Private Sub Form_Open(Cancel As Integer)
On Error GoTo Err_Handler

    'default
    Me.CallingForm = "TemplateList"
    
    If Len(Nz(Me.OpenArgs, "")) > 0 Then Me.CallingForm = Me.OpenArgs

    'minimize Calling Form
    ToggleForm Me.CallingForm, -1

    Me.Caption = "Add Template"
    lblTitle.Caption = ""
    lblDirections.Caption = "Enter template details below using the standard template " & _
                            "naming conventions (see hints below) and save." & vbCrLf & vbCrLf & _
                            "The new template will appear at the bottom of the template list." & vbCrLf & vbCrLf & _
                            "To format your template text, use the Notepad button at right," & vbCrLf & _
                            "then copy && paste it into the template textbox."
    tbxIcon.value = StringFromCodepoint(uLocked)
    tbxIcon.ForeColor = lngDkGreen
    lblDirections.ForeColor = lngLtBlue
    
    lblTemplateNameHint.Caption = "Naming conventions: " & _
                                vbCrLf & Space(30) & "s_ = select" & _
                                Space(8) & "d_ = delete" & _
                                Space(4) & "i_ = insert" & _
                                vbCrLf & Space(30) & "u_ = update" & _
                                Space(4) & "qa_ = QA" & _
                                Space(6) & "qsys_ = system"
    
    lblTemplateMax.Visible = False 'hide by default
    lblTemplateMax.BorderStyle = 1 '0-Transparent, 1-Solid, 2-Dashes, 3-Short dashes,
                                   '4-Dots, 5-Sparse dots, 6-Dash dot, 7-Dash dot dot,
                                   '8-Double solid
    lblTemplateMax.BorderColor = lngRed
    lblTemplateMax.Caption = "Templates over 255 characters must be edited directly " _
                            & "in the template table after saving. " & vbCrLf _
                            & "Save the template, then edit the new template's " _
                            & "SQL text in the table (only the first 255 characters are saved)."
    
    'character counts
    Me.CountLabelVisible = False
    Me.lblCharacterCount.Caption = "Characters Remaining:"
    Me.lblCharacterCount.Visible = True
    Me.MaxCount = 255   'limit to max characters before Template field (Memo) is truncated
    Me.AlertCount = 10
    Me.CurrentCount = Me.MaxCount
    'set hover
    btnDelete.HoverColor = lngGreen
    btnSave.HoverColor = lngGreen
    btnOpenNotepad.HoverColor = lngGreen
    
    btnDelete.Caption = StringFromCodepoint(uDelete)
    btnDelete.ForeColor = lngRed

    'set syntax values
    SetTempVar "EnumType", "SyntaxType"
    Set cbxSyntax.Recordset = GetRecords("s_app_enum_list")
    cbxSyntax.ColumnCount = 3
    cbxSyntax.BoundColumn = 3
    cbxSyntax.ColumnWidths = "0;0;1;"
    cbxSyntax.value = "T-SQL"
    
    'defaults
    btnSave.Enabled = False
    Me.rctAlert.Visible = False
    Me.lblCount.ForeColor = vbBlack
    Me.lblMaxCount.ForeColor = vbBlack
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Open[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          Form_Load
' Description:  form loading actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, October 4, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 10/4/2016 - initial version
' ---------------------------------
Private Sub Form_Load()
On Error GoTo Err_Handler

    'eliminate NULLs
    If IsNull(Me.OpenArgs) Then GoTo Exit_Handler

Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Load[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          Form_Current
' Description:  form current actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, June 1, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 6/1/2016 - initial version
' ---------------------------------
Private Sub Form_Current()
On Error GoTo Err_Handler
       
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Current[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxTemplateSQL_KeyPress
' Description:  Textbox keypress actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, June 28, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 6/28/2016 - initial version
'   BLC - 2/2/2017 - adjusted for TemplateAdd from Task form
' ---------------------------------
Private Sub tbxTemplateSQL_KeyPress(KeyAscii As Integer)
On Error GoTo Err_Handler

    'LimitKeyPress Me.tbxTemplateSQL, 255, KeyAscii
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxTemplateSQL_KeyPress[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxTemplate_Change
' Description:  Textbox actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, February 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub tbxTemplate_Change()
On Error GoTo Err_Handler

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxTemplate_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          cbxSyntax_Change
' Description:  Combobox actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, February 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub cbxSyntax_Change()
On Error GoTo Err_Handler

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - cbxSyntax_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxVersion_Change
' Description:  Textbox actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, February 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub tbxVersion_Change()
On Error GoTo Err_Handler

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxVersion_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxRemarks_Change
' Description:  Textbox actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, February 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub tbxRemarks_Change()
On Error GoTo Err_Handler

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxRemarks_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxEffectiveDate_Change
' Description:  Textbox actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, February 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub tbxEffectiveDate_Change()
On Error GoTo Err_Handler

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxEffectiveDate_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          tbxTemplateSQL_Change
' Description:  tbxTemplateSQL actions on change event
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, November 4, 2015 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 11/4/2015 - initial version
'   BLC - 2/2/2017 - adjusted for template use from comment/task forms
' ---------------------------------
Private Sub tbxTemplateSQL_Change()
On Error GoTo Err_Handler
    
'    LimitChange Me.tbxTask, 255
    
    Me.lblCharacterCount.Caption = "Characters:"
    
    Dim CurrentCount As Integer
    
    CurrentCount = CInt(Me.MaxCount) - Len(tbxTemplateSQL.text)

    Me.lblMaxCount.Caption = CurrentCount & " remaining"
    
    Me.CurrentCountFontColor = vbBlack
    Me.AlertBoxVisible = False
    Me.MaxCountFontColor = vbBlack
    
    Select Case CurrentCount
        Case Is < Me.AlertCount
            Me.AlertBoxVisible = True
            Me.AlertBoxBackgroundColor = lngYellow
            Me.MaxCountFontColor = vbRed
        Case Is = 0
            Me.CurrentCountFontColor = vbRed
        Case Else
    End Select

    If Len(tbxTemplateSQL.text) > Me.MaxCount Then
        Me.lblMaxCount.Caption = -(Me.MaxCount - Len(tbxTemplateSQL.text)) & " over"
    End If
    
        If CurrentCount < 1 Then
        Me.MaxCountFontColor = vbRed
    End If
    
    'hide the templates > 255 notice by default
    Me.lblTemplateMax.Visible = False
    
    If Len(tbxTemplateSQL.text) > CInt(Me.MaxCount) Then
        Me.lblMaxCount.Caption = -CurrentCount & " over"
        
        'display the templates > 255 notice
        Me.lblTemplateMax.Visible = True
        
        'disable save button until count is < or = MaxCount
'        Me.btnSave.Enabled = False
    ElseIf Len(tbxTemplateSQL.text) = 0 Then
        'disable save button if count = 0
'        Me.btnSave.Enabled = False
    Else
        'hide
        're-enable save
'        Me.btnSave.Enabled = True
    End If

    ReadyForSave

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tbxTemplateSQL_Change[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          btnOpenNotepad_Click
' Description:  Open notepad button click actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:
'   InkyRich, June 13, 2008
'   http://www.tek-tips.com/viewthread.cfm?qid=1479936
'   totnAccess, 2003
'   https://www.techonthenet.com/access/modules/notepad.php
' Source/date:  Bonnie Campbell, October 4, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 10/4/2016 - initial version
' ---------------------------------
Private Sub btnOpenNotepad_Click()
On Error GoTo Err_Handler
    
'    Dim dbName As String
'    Dim dbPath As String
'    dbName = Me.Application.CurrentDb.Name
'
'    dbPath = Left(dbName, InStrRev(dbName, "\"))
'
'    AppActivate Shell("Notepad.exe" & dbPath & "temp", 1)

    Call shell("NOTEPAD.EXE", 1)

Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - btnOpenNotepad_Click[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          btnDelete_Click
' Description:  Delete button click actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, June 1, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 6/1/2016 - initial version
' ---------------------------------
Private Sub btnDelete_Click()
On Error GoTo Err_Handler
    
'    Dim result As Integer
'
'    'identify the record ID
'     result = MsgBox("Delete Record this record: #" & tbxID & " ?" _
'                        & vbCrLf & "This action cannot be undone.", vbYesNo, "Delete Record?")
'
'    If result = vbYes Then DeleteRecord "tsys_Db_Templates", tbxID
'
'    'clear the deleted record
'    Me.Requery

Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - btnDelete_Click[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          btnSave_Click
' Description:  Save button click actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, May 31, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 5/31/2016 - initial version
'   BLC - 1/31/2017 - adjusted to set ID value = 0 to signal template add vs. update
'   BLC - 2/1/2017  - adjusted to set hidden context value, removed Me.IsSupported
'                     value is defaulted to 1 for new templates in UpsertRecord
'                     toggle list form (calling form)
' ---------------------------------
Private Sub btnSave_Click()
On Error GoTo Err_Handler
    
    'default IsSupported is 1 (set in UpsertRecord)
    
    'set hidden context field value
    Me.tbxContext.value = Me.tbxTemplate.value
    
    'clear tbxID so templates are considered adds, not updates
    Me.tbxID.value = 0
    
    UpsertRecord Me

    'handle > 255 character SQL templates --> open table to record for editing
    If Len(Me.tbxTemplateSQL) > 255 Then
        DoCmd.OpenTable "tsys_Db_Templates", acViewNormal, acEdit
        DoCmd.GoToRecord acDataTable, "tsys_Db_Templates", acLast
    End If
    
'FIX --> adjust so that when form goes to calling form (TemplateList)
'        that list isn't calling same routine Form_Current
'        multiple times when transitioning back (get focus?)

    'minimize form (calling form will close it)
    ToggleForm Me.Name, -1
    
    'restore list & refresh
    ToggleForm Me.CallingForm, 0
    
    Forms(Me.CallingForm).Requery
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - btnSave_Click[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          lblTemplateMax_Click
' Description:  click template max label actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, January 2, 2017 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 2/2/2017 - initial version
' ---------------------------------
Private Sub lblTemplateMax_Click()
On Error GoTo Err_Handler

    'go to the template record so user can update it
    DoCmd.GoToRecord acDataTable, "tsys_Db_Templates", acLast
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - lblTemplateMax_Click[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          Form_Close
' Description:  form closing actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, October 4, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 10/4/2016 - initial version
' ---------------------------------
Private Sub Form_Close()
On Error GoTo Err_Handler

    'restore Template List
    ToggleForm "TemplateList", 0
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Close[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          ReadyForSave
' Description:  Check if form values are ready to save
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, May 31, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 5/31/2016 - initial version
'   BLC - 8/23/2016 - changed ReadyForSave() to public for mod_App_Data Upsert/SetRecord()
' ---------------------------------
Public Sub ReadyForSave()
On Error GoTo Err_Handler

    Dim isOK As Boolean

    'default
    isOK = False
    
    'set color of icon depending on if values are set
    'requires: site code & name (directions & description optional)
    If Len(Nz(tbxTemplate.value, "")) > 0 _
        And Len(Nz(tbxRemarks.value, "")) > 0 _
        And Len(Nz(tbxTemplateSQL.value, "")) > 0 _
        And Len(Nz(tbxVersion.value, "")) > 0 _
        And Len(Nz(tbxEffectiveDate.value, "")) > 0 _
        Then
        isOK = True
    End If
    
    tbxIcon.ForeColor = IIf(isOK = True, lngDkGreen, lngRed)
    btnSave.Enabled = isOK
    
    'refresh form
    'Me.Requery
        
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - ReadyForSave[TemplateAdd form])"
    End Select
    Resume Exit_Handler
End Sub
